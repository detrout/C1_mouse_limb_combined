"""Combine coverage files for all of our C1 mouse limb data
"""
from glob import glob
from pprint import pprint
import pandas
import os
import sys

from woldrnaseq.models import load_coverage

to_include = """18042_A1
18042_A2
18042_A3
18042_A5
18042_A6
18042_A7
18042_A8
18042_A9
18042_A11
18043_B1
18043_B2
18043_B3
18043_B4
18043_B5
18043_B6
18043_B7
18043_B8
18043_B9
18043_B10
18043_B11
18043_B12
18044_C1
18044_C2
18044_C3
18044_C4
18044_C5
18044_C6
18044_C7
18044_C8
18044_C9
18044_C10
18044_C12
18045_D1
18045_D4
18045_D5
18045_D7
18045_D8
18045_D10
18045_D12
18046_E1
18046_E2
18046_E3
18046_E6
18046_E7
18046_E8
18046_E10
18047_F1
18047_F2
18047_F3
18047_F4
18047_F5
18047_F6
18047_F7
18047_F8
18047_F9
18047_F10
18047_F11
18047_F12
18048_G1
18048_G2
18048_G3
18048_G4
18048_G5
18048_G6
18048_G7
18048_G8
18048_G11
18048_G12
18049_H1
18049_H2
18049_H3
18049_H4
18049_H6
18049_H7
18049_H8
18049_H9
18049_H10
18049_H11
17327_A2
17327_A3
17327_A4
17327_A5
17327_A7
17327_A8
17327_A9
17327_A10
17327_A11
17327_A12
17328_B1
17328_B4
17328_B5
17328_B6
17328_B8
17328_B11
17328_B12
17329_C1
17329_C2
17329_C5
17329_C6
17329_C7
17329_C8
17329_C9
17329_C10
17330_D1
17330_D2
17330_D3
17330_D4
17330_D5
17330_D8
17331_E1
17331_E2
17331_E3
17331_E6
17331_E7
17331_E9
17332_F2
17332_F9
17333_G1
17333_G3
18087_F1
18087_F2
18087_F3
18087_F4
18087_F5
18087_F7
18087_F10
18087_F11
18087_F12
18088_G1
18088_G2
18088_G3
18088_G5
18088_G6
18088_G7
18088_G8
18088_G9
18088_G10
18088_G11
18088_G12
18089_H1
18089_H2
18089_H3
18089_H4
18089_H5
18089_H6
18089_H7
18089_H8
18089_H9
18089_H10
18089_H11
18251_A1_mm10
18251_A3_mm10
18251_A4_mm10
18251_A5_mm10
18251_A6_mm10
18251_A7_mm10
18251_A8_mm10
18251_A10_mm10
18251_A11_mm10
18251_A12_mm10
18252_B1_mm10
18252_B2_mm10
18252_B3_mm10
18252_B4_mm10
18252_B5_mm10
18252_B8_mm10
18252_B9_mm10
18252_B10_mm10
18252_B11_mm10
18252_B12_mm10
18253_C1_mm10
18253_C3_mm10
18253_C4_mm10
18253_C6_mm10
18253_C7_mm10
18253_C8_mm10
18253_C9_mm10
18253_C10_mm10
18253_C11_mm10
18253_C12_mm10
18254_D1_mm10
18254_D2_mm10
18254_D3_mm10
18254_D4_mm10
18254_D6_mm10
18254_D7_mm10
18254_D8_mm10
18254_D9_mm10
18254_D10_mm10
18254_D12_mm10
18255_E1_mm10
18255_E2_mm10
18255_E3_mm10
18255_E4_mm10
18255_E5_mm10
18255_E6_mm10
18255_E7_mm10
18255_E8_mm10
18255_E10_mm10
18255_E11_mm10
18255_E12_mm10
18256_F1_mm10
18256_F2_mm10
18256_F3_mm10
18256_F4_mm10
18256_F6_mm10
18256_F7_mm10
18256_F11_mm10
18257_G2_mm10
18257_G3_mm10
18257_G4_mm10
18257_G6_mm10
18257_G7_mm10
18257_G8_mm10
18257_G9_mm10
18258_A1_mm10
18258_A2_mm10
18258_A3_mm10
18258_A5_mm10
18258_A6_mm10
18258_A7_mm10
18258_A8_mm10
18258_A9_mm10
18258_A10_mm10
18258_A11_mm10
18258_A12_mm10
18259_B1_mm10
18259_B2_mm10
18259_B3_mm10
18259_B4_mm10
18259_B5_mm10
18259_B6_mm10
18259_B7_mm10
18259_B9_mm10
18259_B10_mm10
18259_B11_mm10
18259_B12_mm10
18260_C1_mm10
18260_C3_mm10
18260_C4_mm10
18260_C5_mm10
18260_C7_mm10
18260_C8_mm10
18260_C9_mm10
18260_C10_mm10
18260_C12_mm10
18261_D1_mm10
18261_D2_mm10
18261_D4_mm10
18261_D6_mm10
18261_D7_mm10
18261_D8_mm10
18261_D9_mm10
18261_D10_mm10
18261_D11_mm10
18261_D12_mm10
18262_E1_mm10
18262_E2_mm10
18262_E3_mm10
18262_E5_mm10
18262_E6_mm10
18262_E7_mm10
18262_E8_mm10
18262_E9_mm10
18262_E10_mm10
18262_E11_mm10
18262_E12_mm10
18263_A2_mm10
18263_A3_mm10
18263_A5_mm10
18263_A6_mm10
18263_A7_mm10
18263_A8_mm10
18263_A9_mm10
18263_A10_mm10
18263_A11_mm10
18264_B1_mm10
18264_B2_mm10
18264_B5_mm10
18264_B6_mm10
18264_B7_mm10
18264_B9_mm10
18264_B10_mm10
18264_B11_mm10
18264_B12_mm10
18265_C1_mm10
18265_C2_mm10
18265_C3_mm10
18265_C5_mm10
18265_C6_mm10
18265_C7_mm10
18265_C8_mm10
18265_C9_mm10
18265_C11_mm10
18265_C12_mm10
18266_D2_mm10
18266_D3_mm10
18266_D4_mm10
18266_D5_mm10
18266_D7_mm10
18266_D8_mm10
18266_D9_mm10
18266_D10_mm10
18266_D11_mm10
18266_D12_mm10
18267_E1_mm10
18267_E2_mm10
18267_E5_mm10
18267_E7_mm10
18267_E8_mm10
18267_E11_mm10
18267_E12_mm10
18268_F2_mm10
18268_F4_mm10
18268_F5_mm10
18268_F6_mm10
18268_F9_mm10
18268_F10_mm10
18268_F11_mm10
18269_G1_mm10
18269_G2_mm10
18269_G3_mm10
18269_G4_mm10
18269_G5_mm10
18269_G7_mm10
18269_G8_mm10
18269_G9_mm10
18269_G10_mm10
18269_G11_mm10
18270_A1_mm10
18270_A2_mm10
18270_A3_mm10
18270_A4_mm10
18270_A5_mm10
18270_A6_mm10
18270_A7_mm10
18270_A9_mm10
18270_A10_mm10
18270_A11_mm10
18270_A12_mm10
18271_B1_mm10
18271_B2_mm10
18271_B3_mm10
18271_B4_mm10
18271_B5_mm10
18271_B6_mm10
18271_B7_mm10
18271_B8_mm10
18271_B9_mm10
18271_B10_mm10
18271_B11_mm10
18271_B12_mm10
18272_C1_mm10
18272_C2_mm10
18272_C3_mm10
18272_C4_mm10
18272_C5_mm10
18272_C8_mm10
18272_C9_mm10
18272_C10_mm10
18272_C11_mm10
18272_C12_mm10
18273_D1_mm10
18273_D2_mm10
18273_D3_mm10
18273_D4_mm10
18273_D5_mm10
18273_D6_mm10
18273_D8_mm10
18273_D9_mm10
18273_D11_mm10
18273_D12_mm10
18274_E1_mm10
18274_E2_mm10
18274_E3_mm10
18274_E4_mm10
18274_E5_mm10
18274_E7_mm10
18274_E8_mm10
18274_E9_mm10
18274_E10_mm10
18274_E11_mm10
18274_E12_mm10
18275_F1_mm10
18275_F3_mm10
18275_F4_mm10
18275_F6_mm10
18275_F9_mm10
18275_F11_mm10
18275_F12_mm10
18276_G1_mm10
18276_G3_mm10
18276_G4_mm10
18276_G7_mm10
18276_G9_mm10
18311_A1_mm10
18311_A2_mm10
18311_A6_mm10
18311_A7_mm10
18311_A8_mm10
18311_A9_mm10
18311_A10_mm10
18311_A12_mm10
18312_B1_mm10
18312_B2_mm10
18312_B6_mm10
18312_B8_mm10
18312_B9_mm10
18312_B10_mm10
18312_B11_mm10
18312_B12_mm10
18313_C2_mm10
18313_C3_mm10
18313_C4_mm10
18313_C6_mm10
18314_D6_mm10
18314_D8_mm10
18314_D9_mm10
18314_D10_mm10
18314_D11_mm10
18314_D12_mm10
18315_E10_mm10
18316_F2_mm10
18316_F3_mm10
18316_F6_mm10
18316_F7_mm10
18316_F8_mm10
18316_F9_mm10
18317_G1_mm10
18317_G2_mm10
18317_G5_mm10
18317_G6_mm10
18317_G10_mm10""".split('\n')
libraries = [ x.strip() for x in to_include ]
#to_include.insert(0, 'gene_id')

roots = """/woldlab/castor/home/sau/flowcells/C1_e10.5_mouse_limb_run2_June20_2016/
/woldlab/castor/home/sau/flowcells/H5LV3BCXY/
/woldlab/castor/home/diane/proj/C1_e10.5_mouse_limb_run3_Dec5_2016_2/
/woldlab/castor/home/sau/flowcells/C1_mouse_limb_combined_Mar_2017/
"""



sheets = None
coverage = []
for path in roots.split():
    for lib in libraries:
        coverage_pattern = os.path.join(path, lib, '*.coverage')
        coverage_files = glob(coverage_pattern)
        if len(coverage_files) == 1:
            coverage.append(load_coverage(coverage_files[0], lib))
        elif len(coverage_files) > 1:
            print('too many for {}'.format(lib))
        print(path.split('/')[-2], lib, len(coverage))

coverage_df = pandas.concat(coverage, axis=1)
print(coverage_df.shape)
#pprint(sorted(coverage_df.columns))
coverage_df.to_csv('C1_mouse_limb_combined_coverage.tsv', sep='\t')
