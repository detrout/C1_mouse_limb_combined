\pset format unaligned
\pset fieldsep '\t'
--
-- Attempt to look up metadata and files given a library ID.
with
  experiment as (
  select uri as Experiment,
         payload->>'accession' as Experiment_Accession,
         payload->>'description' as Experiment_Description,
         payload->>'status' as Experiment_Status,
         payload->>'date_released' as Experiment_Released,
         payload->>'assay_title' as Experiment_Type,
         jsonb_array_elements_text(payload->'replicates') as Replicate
  from item
  where object_type = 'Experiment'
  ),
  replicate as (
    select uri as Replicate,
           payload->>'library' as Library,
           payload->>'antibody' as Antibody
    from item
    where object_type = 'Replicate'
  ),
  library as (
    select uri as Library,
           payload->>'accession' as Library_Accession,
           payload->>'date_created' as Library_Created,
           payload->>'biosample' as Biosample
    from item
    where object_type = 'Library'
  ),
  biosample as (
    select uri as Biosample,
           payload->>'age' as age,
           payload->>'age_units' as age_units,
	   payload->>'biosample_term_name' as term_name
    from item
    where object_type = 'Biosample'
  ),
  file as (
    select uri as File,
       payload->>'dataset' as Experiment,
       payload->>'replicate' as Replicate,
       payload->>'submitted_file_name' as filename,
       payload->>'file_type' as file_type
    from item
    where object_type = 'File'
  )
select
  Experiment_Accession,
  Experiment_Description,
  file.File,
  file.filename,
  file.file_type,
  biosample.term_name,
  biosample.age,
  biosample.age_units,
  library.Library,
  library.Biosample,
  to_char(library.Library_Created::date, 'YYYY-MM-DD') as Library_Created
from replicate
  left join library on replicate.Library = library.Library
  left join experiment on experiment.Replicate = replicate.Replicate
  left join file on replicate.Replicate = file.Replicate and
                    experiment.Experiment = file.Experiment
  left join biosample on library.Biosample = biosample.Biosample
where replicate.Library in (
  '/libraries/ENCLB225EDW/',
  '/libraries/ENCLB622OUK/',
  '/libraries/ENCLB417XUK/',
  '/libraries/ENCLB965LID/',
  '/libraries/ENCLB781LYR/',
  '/libraries/ENCLB414WRY/',
  '/libraries/ENCLB727HMU/',
  '/libraries/ENCLB148SWP/',
  '/libraries/ENCLB341SUY/',
  '/libraries/ENCLB982HZY/',
  '/libraries/ENCLB519ONJ/',
  '/libraries/ENCLB705KOS/',
  '/libraries/ENCLB669CLQ/',
  '/libraries/ENCLB352BOK/',
  '/libraries/ENCLB317HVG/',
  '/libraries/ENCLB397WLT/',
  '/libraries/ENCLB024TFN/',
  '/libraries/ENCLB589TKE/',
  '/libraries/ENCLB560OBC/',
  '/libraries/ENCLB616QJT/',
  '/libraries/ENCLB825JVB/',
  '/libraries/ENCLB800HDY/',
  '/libraries/ENCLB991WJB/',
  '/libraries/ENCLB260EDN/',
  '/libraries/ENCLB532WLC/',
  '/libraries/ENCLB518EAH/',
  '/libraries/ENCLB361UPP/',
  '/libraries/ENCLB550QHA/',
  '/libraries/ENCLB307PUD/',
  '/libraries/ENCLB291EOE/',
  '/libraries/ENCLB619JMI/',
  '/libraries/ENCLB433SOY/',
  '/libraries/ENCLB481UJM/',
  '/libraries/ENCLB498LGC/',
  '/libraries/ENCLB144FBG/',
  '/libraries/ENCLB585CBE/',
  '/libraries/ENCLB464ZUJ/',
  '/libraries/ENCLB607DOW/',
  '/libraries/ENCLB241NKP/',
  '/libraries/ENCLB035MOB/',
  '/libraries/ENCLB506KJZ/',
  '/libraries/ENCLB999QJZ/',
  '/libraries/ENCLB311ZPI/',
  '/libraries/ENCLB831DVZ/',
  '/libraries/ENCLB417LQM/',
  '/libraries/ENCLB446WTU/',
  '/libraries/ENCLB867XTG/',
  '/libraries/ENCLB128PTB/',
  '/libraries/ENCLB823NSY/',
  '/libraries/ENCLB562FPM/',
  '/libraries/ENCLB647URY/',
  '/libraries/ENCLB909DVN/',
  '/libraries/ENCLB237CQH/',
  '/libraries/ENCLB454GSM/',
  '/libraries/ENCLB939MVA/',
  '/libraries/ENCLB491JRV/',
  '/libraries/ENCLB141BOM/',
  '/libraries/ENCLB203BRT/',
  '/libraries/ENCLB281UYF/',
  '/libraries/ENCLB860ZWG/',
  '/libraries/ENCLB089GSJ/',
  '/libraries/ENCLB889KXE/',
  '/libraries/ENCLB220JRU/',
  '/libraries/ENCLB518NHR/',
  '/libraries/ENCLB124UBR/',
  '/libraries/ENCLB766HMS/',
  '/libraries/ENCLB911XYU/',
  '/libraries/ENCLB873PWP/',
  '/libraries/ENCLB417JFY/',
  '/libraries/ENCLB969VYT/',
  '/libraries/ENCLB132QES/',
  '/libraries/ENCLB342DFW/',
  '/libraries/ENCLB718JTP/',
  '/libraries/ENCLB097TPC/',
  '/libraries/ENCLB639PYP/',
  '/libraries/ENCLB359HNC/',
  '/libraries/ENCLB732MAT/',
  '/libraries/ENCLB006OTC/',
  '/libraries/ENCLB025BLK/',
  '/libraries/ENCLB188HCS/',
  '/libraries/ENCLB469KQI/',
  '/libraries/ENCLB469FYN/',
  '/libraries/ENCLB972DJP/',
  '/libraries/ENCLB165GGL/',
  '/libraries/ENCLB378MSE/',
  '/libraries/ENCLB455MBV/',
  '/libraries/ENCLB490NFH/',
  '/libraries/ENCLB027DHV/',
  '/libraries/ENCLB143TVK/',
  '/libraries/ENCLB744LSD/',
  '/libraries/ENCLB819GKV/',
  '/libraries/ENCLB781SRC/',
  '/libraries/ENCLB331UBY/',
  '/libraries/ENCLB084JQH/',
  '/libraries/ENCLB079ESG/',
  '/libraries/ENCLB834VSA/',
  '/libraries/ENCLB067JIT/',
  '/libraries/ENCLB367LBB/',
  '/libraries/ENCLB632DVY/',
  '/libraries/ENCLB812YRX/',
  '/libraries/ENCLB874YHW/',
  '/libraries/ENCLB000UFC/',
  '/libraries/ENCLB050HKP/',
  '/libraries/ENCLB886CBK/',
  '/libraries/ENCLB921MCX/',
  '/libraries/ENCLB700MFU/',
  '/libraries/ENCLB705JXV/',
  '/libraries/ENCLB480PDN/',
  '/libraries/ENCLB223DSL/',
  '/libraries/ENCLB134TQG/',
  '/libraries/ENCLB125YTD/',
  '/libraries/ENCLB479ALP/',
  '/libraries/ENCLB021FQV/',
  '/libraries/ENCLB377QNX/',
  '/libraries/ENCLB294DQJ/',
  '/libraries/ENCLB264TLU/',
  '/libraries/ENCLB023JTP/',
  '/libraries/ENCLB897OJB/',
  '/libraries/ENCLB473LST/',
  '/libraries/ENCLB682BLP/',
  '/libraries/ENCLB204VFB/',
  '/libraries/ENCLB951NGG/',
  '/libraries/ENCLB001XBI/',
  '/libraries/ENCLB561OBC/',
  '/libraries/ENCLB750FQE/',
  '/libraries/ENCLB748BWO/',
  '/libraries/ENCLB439RMS/',
  '/libraries/ENCLB512MFK/',
  '/libraries/ENCLB244MKQ/',
  '/libraries/ENCLB337WYE/',
  '/libraries/ENCLB358BQT/',
  '/libraries/ENCLB736GHZ/',
  '/libraries/ENCLB555OBC/',
  '/libraries/ENCLB659MSF/',
  '/libraries/ENCLB141PCW/',
  '/libraries/ENCLB450EFB/',
  '/libraries/ENCLB691XWF/',
  '/libraries/ENCLB346NQQ/',
  '/libraries/ENCLB805WXR/',
  '/libraries/ENCLB744EEO/',
  '/libraries/ENCLB804FCG/',
  '/libraries/ENCLB675QXQ/',
  '/libraries/ENCLB914EOC/',
  '/libraries/ENCLB914ZWT/',
  '/libraries/ENCLB712KKU/',
  '/libraries/ENCLB819FPL/',
  '/libraries/ENCLB666IAP/',
  '/libraries/ENCLB422SNM/',
  '/libraries/ENCLB235BRC/',
  '/libraries/ENCLB641NIT/',
  '/libraries/ENCLB283AGL/',
  '/libraries/ENCLB533WWU/',
  '/libraries/ENCLB509EXL/',
  '/libraries/ENCLB824JML/',
  '/libraries/ENCLB363LOD/',
  '/libraries/ENCLB880MKJ/',
  '/libraries/ENCLB597SRF/',
  '/libraries/ENCLB824FCI/',
  '/libraries/ENCLB657GCD/',
  '/libraries/ENCLB222PXJ/',
  '/libraries/ENCLB008YNB/',
  '/libraries/ENCLB473EVL/',
  '/libraries/ENCLB570VNG/',
  '/libraries/ENCLB734GGG/',
  '/libraries/ENCLB236ASD/',
  '/libraries/ENCLB889HEB/',
  '/libraries/ENCLB281DTJ/',
  '/libraries/ENCLB133CBJ/',
  '/libraries/ENCLB849SNX/',
  '/libraries/ENCLB170URF/',
  '/libraries/ENCLB725RYW/',
  '/libraries/ENCLB143QMW/',
  '/libraries/ENCLB001IEC/',
  '/libraries/ENCLB508EVI/',
  '/libraries/ENCLB677YHU/',
  '/libraries/ENCLB374DWN/',
  '/libraries/ENCLB207ETY/',
  '/libraries/ENCLB452LLH/',
  '/libraries/ENCLB977BAR/',
  '/libraries/ENCLB207VQE/',
  '/libraries/ENCLB325KEU/',
  '/libraries/ENCLB769QVT/',
  '/libraries/ENCLB412PJO/',
  '/libraries/ENCLB074OSL/',
  '/libraries/ENCLB748XGG/',
  '/libraries/ENCLB118BDL/',
  '/libraries/ENCLB884MVI/',
  '/libraries/ENCLB047ABB/',
  '/libraries/ENCLB012UHV/',
  '/libraries/ENCLB439GMY/',
  '/libraries/ENCLB423DUU/',
  '/libraries/ENCLB455VYE/',
  '/libraries/ENCLB094IGC/',
  '/libraries/ENCLB253SMX/',
  '/libraries/ENCLB840UIO/',
  '/libraries/ENCLB786MXQ/',
  '/libraries/ENCLB187UYU/',
  '/libraries/ENCLB161BMB/',
  '/libraries/ENCLB507QWA/',
  '/libraries/ENCLB409LNV/',
  '/libraries/ENCLB095BWE/',
  '/libraries/ENCLB703EOJ/',
  '/libraries/ENCLB573XAG/',
  '/libraries/ENCLB427RUS/',
  '/libraries/ENCLB118RPP/',
  '/libraries/ENCLB132QBS/',
  '/libraries/ENCLB797AWF/',
  '/libraries/ENCLB107SBM/',
  '/libraries/ENCLB655CDC/',
  '/libraries/ENCLB679MFY/',
  '/libraries/ENCLB659XUT/',
  '/libraries/ENCLB527GTH/',
  '/libraries/ENCLB252TCV/',
  '/libraries/ENCLB303KMO/',
  '/libraries/ENCLB406XWO/',
  '/libraries/ENCLB430DYX/',
  '/libraries/ENCLB239EBJ/',
  '/libraries/ENCLB330LDJ/',
  '/libraries/ENCLB621DPZ/',
  '/libraries/ENCLB948UIZ/',
  '/libraries/ENCLB215RJO/',
  '/libraries/ENCLB968YJF/',
  '/libraries/ENCLB846CAR/',
  '/libraries/ENCLB368HBT/',
  '/libraries/ENCLB462XCO/',
  '/libraries/ENCLB158WMI/',
  '/libraries/ENCLB998ICI/',
  '/libraries/ENCLB480XWZ/',
  '/libraries/ENCLB716EUG/',
  '/libraries/ENCLB071EWE/',
  '/libraries/ENCLB319MPS/',
  '/libraries/ENCLB385BFU/',
  '/libraries/ENCLB149QLR/',
  '/libraries/ENCLB673BKL/',
  '/libraries/ENCLB227ZIO/',
  '/libraries/ENCLB165LHC/',
  '/libraries/ENCLB392LYU/',
  '/libraries/ENCLB462QDV/',
  '/libraries/ENCLB057HYC/',
  '/libraries/ENCLB535QXZ/',
  '/libraries/ENCLB730EGN/',
  '/libraries/ENCLB141YEX/',
  '/libraries/ENCLB849POY/',
  '/libraries/ENCLB920JOQ/',
  '/libraries/ENCLB430YPH/',
  '/libraries/ENCLB620QIG/',
  '/libraries/ENCLB402EVU/',
  '/libraries/ENCLB006SOH/',
  '/libraries/ENCLB718RWV/',
  '/libraries/ENCLB569NUQ/',
  '/libraries/ENCLB413PDA/',
  '/libraries/ENCLB443IAT/',
  '/libraries/ENCLB040ZEF/',
  '/libraries/ENCLB113OMP/',
  '/libraries/ENCLB053MXU/',
  '/libraries/ENCLB628OHJ/',
  '/libraries/ENCLB434WSX/',
  '/libraries/ENCLB118WLX/',
  '/libraries/ENCLB629KKZ/',
  '/libraries/ENCLB563VMZ/',
  '/libraries/ENCLB950DGI/',
  '/libraries/ENCLB963CMU/',
  '/libraries/ENCLB387YWD/',
  '/libraries/ENCLB278CYE/',
  '/libraries/ENCLB781NVH/',
  '/libraries/ENCLB858EPU/',
  '/libraries/ENCLB506KYQ/',
  '/libraries/ENCLB986VGY/',
  '/libraries/ENCLB663WFU/',
  '/libraries/ENCLB986KWP/',
  '/libraries/ENCLB200ISH/',
  '/libraries/ENCLB716RQE/',
  '/libraries/ENCLB038PEC/',
  '/libraries/ENCLB171XVN/',
  '/libraries/ENCLB305UGO/',
  '/libraries/ENCLB891FNC/',
  '/libraries/ENCLB722CIL/',
  '/libraries/ENCLB182SBH/',
  '/libraries/ENCLB012BTW/',
  '/libraries/ENCLB484GQY/',
  '/libraries/ENCLB185DFV/',
  '/libraries/ENCLB047NFK/',
  '/libraries/ENCLB644EBJ/',
  '/libraries/ENCLB956QMD/',
  '/libraries/ENCLB418PAS/',
  '/libraries/ENCLB269VKF/',
  '/libraries/ENCLB148LFW/',
  '/libraries/ENCLB442UED/',
  '/libraries/ENCLB726UKO/',
  '/libraries/ENCLB540JMP/',
  '/libraries/ENCLB678FRW/',
  '/libraries/ENCLB673DWE/',
  '/libraries/ENCLB084VFF/',
  '/libraries/ENCLB814FBW/',
  '/libraries/ENCLB135IGI/',
  '/libraries/ENCLB146PTT/',
  '/libraries/ENCLB415GNB/',
  '/libraries/ENCLB964MFE/',
  '/libraries/ENCLB551IKN/',
  '/libraries/ENCLB802OOO/',
  '/libraries/ENCLB461RIV/',
  '/libraries/ENCLB982FXI/',
  '/libraries/ENCLB929YRQ/',
  '/libraries/ENCLB015YQB/',
  '/libraries/ENCLB437QRV/',
  '/libraries/ENCLB852FEJ/',
  '/libraries/ENCLB243UHW/',
  '/libraries/ENCLB717ARY/',
  '/libraries/ENCLB609TNA/',
  '/libraries/ENCLB928JSO/',
  '/libraries/ENCLB439HQY/',
  '/libraries/ENCLB748LNX/',
  '/libraries/ENCLB056UXC/',
  '/libraries/ENCLB413GKO/',
  '/libraries/ENCLB681SUT/',
  '/libraries/ENCLB446NBD/',
  '/libraries/ENCLB506KTH/',
  '/libraries/ENCLB269SAJ/',
  '/libraries/ENCLB338PJQ/',
  '/libraries/ENCLB834PDX/',
  '/libraries/ENCLB464MFE/',
  '/libraries/ENCLB885GUY/',
  '/libraries/ENCLB301ILD/',
  '/libraries/ENCLB750UYN/',
  '/libraries/ENCLB694BCC/',
  '/libraries/ENCLB436RCL/',
  '/libraries/ENCLB708NDI/',
  '/libraries/ENCLB760KRO/',
  '/libraries/ENCLB265TPP/',
  '/libraries/ENCLB201EGC/',
  '/libraries/ENCLB011LLP/',
  '/libraries/ENCLB565SNW/',
  '/libraries/ENCLB002UBY/',
  '/libraries/ENCLB824XNO/',
  '/libraries/ENCLB475IMM/',
  '/libraries/ENCLB757ACM/',
  '/libraries/ENCLB668OGF/',
  '/libraries/ENCLB374HBB/',
  '/libraries/ENCLB056BCH/',
  '/libraries/ENCLB982YRV/',
  '/libraries/ENCLB198YGK/',
  '/libraries/ENCLB594OCT/',
  '/libraries/ENCLB498ZBB/',
  '/libraries/ENCLB489DOB/',
  '/libraries/ENCLB662QDJ/',
  '/libraries/ENCLB335FIJ/',
  '/libraries/ENCLB114YKQ/',
  '/libraries/ENCLB057DNX/',
  '/libraries/ENCLB828BSW/',
  '/libraries/ENCLB970QJJ/',
  '/libraries/ENCLB820SXB/',
  '/libraries/ENCLB669CIM/',
  '/libraries/ENCLB073JYL/',
  '/libraries/ENCLB471WYK/',
  '/libraries/ENCLB161CWB/',
  '/libraries/ENCLB970MYL/',
  '/libraries/ENCLB314UEG/',
  '/libraries/ENCLB326DCW/',
  '/libraries/ENCLB410LYZ/',
  '/libraries/ENCLB017YSR/',
  '/libraries/ENCLB418VYU/',
  '/libraries/ENCLB669BRQ/',
  '/libraries/ENCLB063VQL/',
  '/libraries/ENCLB273GGN/',
  '/libraries/ENCLB607YDK/',
  '/libraries/ENCLB598AJW/',
  '/libraries/ENCLB878ZZX/',
  '/libraries/ENCLB955MAO/',
  '/libraries/ENCLB778LIY/',
  '/libraries/ENCLB737UFS/',
  '/libraries/ENCLB834QEZ/',
  '/libraries/ENCLB671BPR/',
  '/libraries/ENCLB821RUE/',
  '/libraries/ENCLB627ARY/',
  '/libraries/ENCLB891QFO/',
  '/libraries/ENCLB343DSK/',
  '/libraries/ENCLB793ZGA/',
  '/libraries/ENCLB563GXZ/',
  '/libraries/ENCLB319GFB/',
  '/libraries/ENCLB323HOX/',
  '/libraries/ENCLB138OEY/',
  '/libraries/ENCLB249MFV/',
  '/libraries/ENCLB006SIX/',
  '/libraries/ENCLB798OHJ/',
  '/libraries/ENCLB331CGO/',
  '/libraries/ENCLB323WIZ/',
  '/libraries/ENCLB742HEG/',
  '/libraries/ENCLB491YQO/',
  '/libraries/ENCLB325SLV/',
  '/libraries/ENCLB925NUF/',
  '/libraries/ENCLB440YTS/',
  '/libraries/ENCLB810QFN/',
  '/libraries/ENCLB429PKP/',
  '/libraries/ENCLB468RKB/',
  '/libraries/ENCLB597OIS/',
  '/libraries/ENCLB385WFA/',
  '/libraries/ENCLB229DOT/',
  '/libraries/ENCLB554TQM/',
  '/libraries/ENCLB046LAZ/',
  '/libraries/ENCLB515UFG/',
  '/libraries/ENCLB228XNN/',
  '/libraries/ENCLB185ZMZ/',
  '/libraries/ENCLB546QXH/',
  '/libraries/ENCLB841HNQ/',
  '/libraries/ENCLB901XOR/',
  '/libraries/ENCLB306NFD/',
  '/libraries/ENCLB615OTZ/',
  '/libraries/ENCLB352SSH/',
  '/libraries/ENCLB793KHF/',
  '/libraries/ENCLB057APZ/',
  '/libraries/ENCLB611WXM/',
  '/libraries/ENCLB678INC/',
  '/libraries/ENCLB232LWK/',
  '/libraries/ENCLB863QNF/',
  '/libraries/ENCLB155IPS/',
  '/libraries/ENCLB809JUU/',
  '/libraries/ENCLB941FOL/',
  '/libraries/ENCLB991DXR/',
  '/libraries/ENCLB719FMA/',
  '/libraries/ENCLB679MZK/',
  '/libraries/ENCLB348WUK/',
  '/libraries/ENCLB220SGE/',
  '/libraries/ENCLB227IKK/',
  '/libraries/ENCLB641XZU/',
  '/libraries/ENCLB540DJV/',
  '/libraries/ENCLB182FYD/',
  '/libraries/ENCLB536TNK/',
  '/libraries/ENCLB660VBS/',
  '/libraries/ENCLB724DQR/',
  '/libraries/ENCLB657QIE/',
  '/libraries/ENCLB377GCA/',
  '/libraries/ENCLB327ADL/',
  '/libraries/ENCLB751PUH/'
)
order by experiment_description
-- limit 10
;
